<!DOCTYPE html>
<html lang="pt-br" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:pe="http://primefaces.org/ui/extensions">

<ui:composition template="template.xhtml">

	<ui:define name="head">
		<h:outputStylesheet library="css" name="cadastrar-cliente.css" />
	</ui:define>

	<ui:define name="conteudo">

		<div class="body-container">
			<h:panelGroup id="cadastro" layout="block" styleClass="ui-fluid">
				<div class="container">
					<div class="forms">
						<div class="form login">
							<span class="title">Cadastro de Cliente</span>

							<p:growl id="growl" />

							<div class="ui-fluid">
								<div>
									<p:selectOneRadio id="tipo-pessoa" required="true"
										value="#{clienteController.pessoaJuridica}"
										unselectable="true" style="margin-top: 0.7em;">
										<f:selectItem itemLabel="Pessoa Física" itemValue="false" />
										<f:selectItem itemLabel="Pessoa Jurídica" itemValue="true" />
										<p:ajax listener="#{clienteController.limpar}" process="@this"
											update="@form:cadastro" />
									</p:selectOneRadio>
								</div>
								<h:panelGroup layout="block"
									rendered="#{clienteController.pessoaJuridica == false}">

									<div class="ui-fluid p-formgrid p-grid">
										<div class="p-field p-col-12 p-md-6">
											<p:outputLabel for="nome" value="Nome" />
											<p:inputText id="nome" type="text" value="#{clienteController.entity.pessoa.nome}" />
										</div>
										<div class="p-field p-col-12 p-md-6">
											<p:outputLabel for="sobrenome" value="Sobrenome" />
											<p:inputText id="sobrenome" type="text" value="#{clienteController.entity.pessoa.sobreNome}"/>
										</div>

										<div class="p-field p-col-12 p-md-6">
											<p:outputLabel value="CPF" />
											<p:inputMask mask="999.999.999-99" id="cpf" maxlength="14"
												value="#{clienteController.entity.pessoa.cpf}"/>
										</div>

										<div class="p-field p-col-12 p-md-6">
											<p:outputLabel value="Sexo" />
											<p:selectOneRadio
												value="#{clienteController.entity.pessoa.sexo}">
												<f:selectItems var="obj"
													value="#{clienteController.listaSexo}"
													itemLabel="#{obj.label}" />
											</p:selectOneRadio>
										</div>

										<div class="p-field p-col-12 p-md-6">
											<p:outputLabel for="data-nascimento"
												value="Data de Nascimento" />
											<p:datePicker id="data-nascimento"
												value="#{clienteController.entity.pessoa.dataNascimento}"
												monthNavigator="true" pattern="dd/MM/yyyy" mask="99/99/9999" />
										</div>
									</div>
								</h:panelGroup>

								<h:panelGroup layout="block"
									rendered="#{clienteController.pessoaJuridica}">

									<p:outputLabel value="CNPJ" />
									<p:inputMask value="#{clienteController.entity.pessoa.cnpj}"
										mask="99.999.999/9999-99" id="cnpj" maxlength="18" />
								</h:panelGroup>

								<div class="p-field p-col-12 p-md-6">
									<p:outputLabel for="email" value="Email" />
									<p:inputText value="#{clienteController.entity.email}"
										id="email" type="email" />
								</div>
								
								<div class="p-field p-col-12 p-md-6">
									<p:outputLabel for="phone" value="Telefone" />
									<p:inputText value="#{clienteController.entity.pessoa.telefone}"
										id="phone" type="text" />
								</div>

								<p:dialog header="Adicionar Enderenço" widgetVar="dlg"
									minHeight="100" width="30%" showEffect="fade" modal="true"
									resizable="false" closeOnEscape="true">
									<p:panel id="endereco">

										<div class="ui-fluid">

											<p:messages closable="true" id="messages" styleClass="p-mr-2"
												errorStyle="color:red;margin:8px;"
												warnStyle="color:yellow;margin:8px;"
												infoStyle="color:green;margin:8px;">
												<p:autoUpdate />
											</p:messages>

											<p:outputLabel value="CEP " />
											<div class="ui-inputgroup">
												<p:inputMask mask="99999-999" id="cep" maxlength="9"
													value="#{clienteController.entity.endereco.cep}" />
												<p:commandButton
													actionListener="#{clienteController.buscarCep}"
													icon="pi pi-search" process="@this @form:cep"
													update="@form:endereco" styleClass="ui-button-warning" />
											</div>

											<div>
												<p:outputLabel value="Rua" />
												<p:inputText id="rua"
													value="#{clienteController.entity.endereco.rua}" />
											</div>

											<div>
												<p:outputLabel value="Número" />
												<p:inputText id="numero"
													value="#{clienteController.entity.endereco.numero}" />
											</div>

											<div>
												<p:outputLabel value="Bairro" />
												<p:inputText id="bairro"
													value="#{clienteController.entity.endereco.bairro}" />
											</div>

											<div>
												<p:outputLabel value="Estado" />
												<p:autoComplete id="estado"
													value="#{clienteController.entity.endereco.cidade.estado.nome}"
													completeMethod="#{estadoUtil.completeText}"
													scrollHeight="250" placeholder="Digite o Estado"
													forceSelection="true">

													<p:ajax event="itemSelect"
														listener="#{clienteController.onItemSelect}"
														process="@form:endereco" update="@form:endereco" />
												</p:autoComplete>
											</div>

											<div>
												<p:outputLabel value="Cidade " />
												<p:autoComplete id="cidade"
													value="#{clienteController.entity.endereco.cidade.nome}"
													completeMethod="#{cidadeUtil.completeText}"
													scrollHeight="250" placeholder="Digite a Cidade"
													disabled="#{clienteController.entity.endereco.cidade.estado.nome == null}" />
											</div>

											<div>
												<p:commandButton value="Salvar" icon="pi pi-plus"
													styleClass="ui-button-success" onclick="PF('dlg').hide()"
													process="@this" />
											</div>
										</div>
									</p:panel>
								</p:dialog>

								<div class="p-d-inline">
									<h:panelGroup layout="block">
										<p:commandButton value="Adicionar Endereço" icon="pi pi-add"
											onclick="PF('dlg').show()" process="@this" />
									</h:panelGroup>
									<div>
										<p:commandButton value="Cadastrar"
											styleClass="ui-button-success"
											action="#{clienteController.cadastrar}"
											process="@form:cadastro" update="@form:cadastro" />
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</h:panelGroup>
		</div>

		<h:outputScript library="js" name="cadastro-cliente.js" />
	</ui:define>
</ui:composition>
</html>